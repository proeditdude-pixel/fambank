<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#F4F7FE">
    <title>FamBank</title>
    <style>
        /* --- 1. THEME VARIABLES --- */
        :root {
            --primary: #4D8EFF;
            --accent: #FFB142;
            --success: #00D68F;
            --error: #FF6B6B;
            --bg-body: #F4F7FE;
            --text-main: #2C3A59;
            --text-sec: #8F9BB3;
            --radius: 25px;
            --shadow: 0 10px 30px rgba(77, 142, 255, 0.15);
            --safe-top: env(safe-area-inset-top);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Nunito", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- 2. ANIMATIONS --- */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* --- 3. UI ELEMENTS --- */
        input {
            width: 100%; padding: 18px; font-size: 16px;
            border: 2px solid transparent; background: #EEF2F9;
            border-radius: var(--radius); margin-bottom: 15px;
            color: var(--text-main); font-weight: 700; transition: 0.3s;
        }
        input:focus { background: white; border-color: var(--primary); box-shadow: 0 4px 12px rgba(77, 142, 255, 0.2); }

        .btn {
            width: 100%; padding: 16px;
            background: var(--primary); color: white;
            border: none; border-radius: var(--radius);
            font-size: 16px; font-weight: 800; cursor: pointer;
            box-shadow: 0 4px 15px rgba(77, 142, 255, 0.3);
            transition: transform 0.1s;
            display: flex; justify-content: center; align-items: center;
        }
        .btn:active { transform: scale(0.96); }
        .btn.secondary { background: #E4E9F2; color: var(--text-main); box-shadow: none; }
        
        .google-btn { 
            background: white; color: #3c4043; 
            border: 1px solid #dadce0; box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
            margin-bottom: 20px; 
        }
        .google-btn svg { margin-right: 10px; }

        /* Custom Toast Message (Error/Success) */
        .toast-msg {
            font-size: 14px; font-weight: 700; 
            margin-top: 10px; min-height: 20px; text-align: center;
            opacity: 0; transition: opacity 0.3s;
        }
        .toast-msg.show { opacity: 1; animation: shake 0.3s; }
        .toast-msg.error { color: var(--error); }
        .toast-msg.success { color: var(--success); }

        /* --- 4. LAYOUT --- */
        .main-content {
            flex: 1; position: relative; overflow-y: auto;
            background: var(--bg-body); height: 100%;
        }

        .view {
            display: none; padding: 25px; padding-bottom: 120px;
            max-width: 800px; margin: 0 auto;
            animation: fadeUp 0.4s ease-out;
        }
        .view.active { display: block; }

        /* --- 5. NAVIGATION (HIDDEN INITIALLY) --- */
        .sidebar {
            width: 280px; background: white;
            display: none; /* Controlled by JS */
            flex-direction: column; padding: 30px;
            border-right: 1px solid #EEF2F9; z-index: 50;
        }
        .nav-item {
            display: flex; align-items: center; padding: 15px 20px;
            margin-bottom: 8px; border-radius: 18px;
            color: var(--text-sec); font-weight: 700; cursor: pointer; transition: 0.2s;
        }
        .nav-item:hover { background: #F4F7FE; color: var(--primary); }
        .nav-item.active { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(77, 142, 255, 0.4); }

        .mobile-nav {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: white; height: 75px; border-radius: 40px;
            display: none; /* Controlled by JS */
            justify-content: space-around; align-items: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); z-index: 100;
        }
        .mobile-tab { 
            color: #C5CEE0; width: 50px; height: 50px; 
            display: flex; justify-content: center; align-items: center;
            border-radius: 50%; transition: 0.3s;
        }
        .mobile-tab.active { color: white; background: var(--primary); transform: translateY(-5px); box-shadow: 0 5px 15px rgba(77, 142, 255, 0.4); }

        .mobile-header {
            position: fixed; top: 0; left: 0; width: 100%; height: 70px;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            display: none; /* Controlled by JS */
            align-items: center; justify-content: center;
            font-weight: 800; font-size: 18px; color: var(--text-main);
            z-index: 90; padding-top: var(--safe-top);
        }

        /* --- 6. AUTH & SETUP OVERLAYS --- */
        #auth-view {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-body); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
        }
        .auth-card {
            background: white; width: 100%; max-width: 450px; padding: 40px;
            border-radius: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.05);
            text-align: center; margin: 20px;
        }

        /* --- 7. LOADING & LISTS --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 10000;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            transition: opacity 0.5s;
        }
        .bubble-list { display: flex; flex-direction: column; gap: 15px; }
        .list-item {
            background: white; padding: 20px; border-radius: 25px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03); cursor: pointer;
        }

    </style>
</head>
<body>

    <div id="loader">
        <div style="font-size:60px; animation: shake 2s infinite;">üè¶</div>
    </div>

    <div class="sidebar" id="desktop-sidebar">
        <div style="font-size:24px; font-weight:900; color:var(--primary); margin-bottom:40px; padding-left:10px;">üè¶ FamBank</div>
        <div class="nav-item active" onclick="switchNav('home-view')" id="pc-home">üè† Home</div>
        <div class="nav-item" onclick="switchNav('family-view')" id="pc-fam">üë®‚Äçüë©‚Äçüëß Family</div>
        <div class="nav-item" onclick="switchNav('store-view')" id="pc-store">üõçÔ∏è Store</div>
        <div class="nav-item" onclick="switchNav('profile-view')" id="pc-prof">üë§ Profile</div>
        <div style="flex:1;"></div>
        <div class="nav-item" style="color:#FF6B6B;" onclick="logout()">üö™ Log Out</div>
    </div>

    <div class="main-content">
        <div class="mobile-header" id="header-title">Home</div>

        <div id="auth-view" class="view active">
            <div class="auth-card">
                <div style="font-size:60px; margin-bottom:10px;">üëã</div>
                <h1>Welcome!</h1>
                <p>Sign in to manage your family.</p>
                
                <button class="btn google-btn" onclick="loginGoogle()">
                    <svg width="18" height="18" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>
                    Continue with Google
                </button>

                <div style="display:flex; align-items:center; margin:20px 0; color:#C5CEE0;">
                    <div style="flex:1; height:2px; background:#EEF2F9;"></div>
                    <span style="padding:0 10px; font-size:12px; font-weight:800;">OR</span>
                    <div style="flex:1; height:2px; background:#EEF2F9;"></div>
                </div>

                <input type="email" id="email-in" placeholder="Email">
                <input type="password" id="pass-in" placeholder="Password">
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn" style="flex:1;" onclick="loginEmail()">Log In</button>
                    <button class="btn secondary" style="flex:1;" onclick="signupEmail()">Sign Up</button>
                </div>
                
                <div id="auth-feedback" class="toast-msg"></div>
            </div>
        </div>

        <div id="setup-view" class="view" style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:9999; background:var(--bg-body); display:none; align-items:center; justify-content:center;">
            <div class="auth-card">
                <div style="font-size:60px; margin-bottom:10px;">üìù</div>
                <h1>One last thing!</h1>
                <p>What should we call you?</p>
                <input type="text" id="setup-name" placeholder="Your Name (e.g. Dad, Mom)">
                <button class="btn" onclick="finalizeSetup()">Let's Go!</button>
            </div>
        </div>

        <div id="home-view" class="view">
            <div style="background: linear-gradient(135deg, var(--primary), #6C5CE7); color: white; padding: 35px; border-radius: 35px; box-shadow: var(--shadow); position:relative; overflow:hidden;">
                <p style="color:rgba(255,255,255,0.9); margin:0; text-transform:uppercase; font-size:12px; font-weight:800;">Balance</p>
                <h1 style="color:white; font-size:60px; margin: 10px 0;" id="coin-count">0</h1>
                <div style="font-weight:700;">Tokens</div>
            </div>

            <h2 style="margin: 30px 0 20px 5px;">Tasks</h2>
            
            <div id="no-fam-alert" style="display:none; background:white; padding:30px; border-radius:30px; text-align:center; box-shadow: 0 4px 20px rgba(0,0,0,0.03);">
                <div style="font-size:40px; margin-bottom:15px;">üë®‚Äçüë©‚Äçüëß</div>
                <h3>No Family Yet</h3>
                <p>Join or create a family to see tasks.</p>
                <button class="btn secondary" onclick="switchNav('family-view')">Go to Family</button>
            </div>

            <div id="task-list" class="bubble-list"></div>
        </div>

        <div id="family-view" class="view">
            <h1>Family</h1>
            <div id="family-forms">
                <div style="background:white; padding:30px; border-radius:30px; margin-bottom:20px;">
                    <h3>New Group</h3>
                    <input type="text" id="create-fam-name" placeholder="Family Name">
                    <button class="btn" onclick="createFamily()">Create</button>
                </div>
                <div style="text-align:center; color:var(--text-sec); font-weight:800; margin:20px;">OR</div>
                <div style="background:white; padding:30px; border-radius:30px;">
                    <h3>Join Group</h3>
                    <input type="number" id="join-fam-code" placeholder="Invite Code">
                    <button class="btn secondary" onclick="joinFamily()">Join</button>
                    <div id="join-error" class="toast-msg error"></div>
                </div>
            </div>

            <div id="family-info" style="display:none;">
                <div class="bubble-list">
                    <div class="list-item" style="cursor:default;">
                        <div>
                            <div style="font-size:12px; color:var(--text-sec); font-weight:800;">NAME</div>
                            <div style="font-size:20px; font-weight:800;" id="fam-name-display">...</div>
                        </div>
                        <div style="font-size:30px;">üè†</div>
                    </div>
                    <div class="list-item" style="background:#FFF8E1; cursor:default;">
                        <div>
                            <div style="font-size:12px; color:#FF8F00; font-weight:800;">INVITE CODE</div>
                            <div style="font-size:28px; font-weight:900; letter-spacing:4px; color:#FF6F00;" id="fam-code-display">....</div>
                        </div>
                        <div style="font-size:30px;">üîë</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="store-view" class="view">
            <h1>Store</h1>
            <div class="bubble-list">
                <div class="list-item">
                    <div style="display:flex; align-items:center;">
                        <div style="font-size:24px; margin-right:15px;">üç¶</div>
                        <div><div style="font-weight:800;">Ice Cream</div><div style="color:var(--primary);">100 Tokens</div></div>
                    </div>
                    <button class="btn" style="width:auto; padding:10px 20px; margin:0; font-size:14px;">Buy</button>
                </div>
            </div>
        </div>

        <div id="profile-view" class="view">
            <h1>Profile</h1>
            <div class="bubble-list">
                <div class="list-item" style="cursor:default;">
                    <div>
                        <div style="font-size:12px; color:var(--text-sec); font-weight:800;">NAME</div>
                        <div style="font-size:18px; font-weight:700;" id="display-name">...</div>
                    </div>
                </div>
                <div class="list-item" style="cursor:default;">
                    <div>
                        <div style="font-size:12px; color:var(--text-sec); font-weight:800;">EMAIL</div>
                        <div style="font-size:16px; font-weight:600;" id="user-email">...</div>
                    </div>
                </div>
            </div>
            <button class="btn" style="background:#FF6B6B; margin-top:30px;" onclick="logout()">Log Out</button>
        </div>
    </div>

    <div class="mobile-nav" id="mobile-navbar">
        <div class="mobile-tab active" onclick="switchNav('home-view')"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></div>
        <div class="mobile-tab" onclick="switchNav('profile-view')"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg></div>
        <div class="mobile-tab" onclick="openSheet()"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg></div>
    </div>

    <div class="sheet-overlay" id="sheet-overlay" onclick="closeSheet(event)" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:200; opacity:0; pointer-events:none; transition:0.3s;">
        <div class="sheet-card" style="position:absolute; bottom:20px; left:20px; right:20px; background:white; border-radius:30px; padding:25px; transform:translateY(150%); transition:0.4s;">
            <div style="width:50px; height:6px; background:#EEF2F9; border-radius:10px; margin:0 auto 20px auto;"></div>
            <h2>More</h2>
            <div class="bubble-list">
                <div class="list-item" onclick="mobileGo('family-view')"><div style="font-weight:700;">üë®‚Äçüë©‚Äçüëß Family Group</div></div>
                <div class="list-item" onclick="mobileGo('store-view')"><div style="font-weight:700;">üõçÔ∏è Rewards Store</div></div>
            </div>
        </div>
    </div>
    <style>.sheet-overlay.open { opacity: 1; pointer-events: auto; } .sheet-overlay.open .sheet-card { transform: translateY(0); }</style>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        // ADDED: sendEmailVerification
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, onSnapshot, updateDoc, doc, getDoc, setDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCBoSEjCf3tECszYAUqed6hGntmL77JJ7Q",
            authDomain: "fambank-c839c.firebaseapp.com",
            projectId: "fambank-c839c",
            storageBucket: "fambank-c839c.firebasestorage.app",
            messagingSenderId: "875048284285",
            appId: "1:875048284285:web:0a1cf3c5f980015e210114"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        let currentUser = null;
        let userData = null;

        // --- HELPER FOR TOAST MESSAGES ---
        function showToast(id, msg, type) {
            const el = document.getElementById(id);
            el.innerText = msg;
            el.className = `toast-msg show ${type}`; // e.g. "toast-msg show error"
            setTimeout(() => {
                el.classList.remove('show');
            }, 4000);
        }

        // --- AUTH FUNCTIONS ---
        window.loginGoogle = () => signInWithPopup(auth, provider).catch(e => showToast('auth-feedback', "Google Login Failed", "error"));
        
        window.loginEmail = () => signInWithEmailAndPassword(auth, document.getElementById('email-in').value, document.getElementById('pass-in').value)
            .catch(e => showToast('auth-feedback', "Wrong Email or Password", "error"));

        // UPDATED: Signup with Verification
        window.signupEmail = async () => {
            const email = document.getElementById('email-in').value;
            const pass = document.getElementById('pass-in').value;
            
            if(!email || !pass) return showToast('auth-feedback', "Please enter email & password", "error");

            try {
                const cred = await createUserWithEmailAndPassword(auth, email, pass);
                // Send verification email
                await sendEmailVerification(cred.user);
                showToast('auth-feedback', "Account Created! Verification email sent.", "success");
                // The onAuthStateChanged will handle the transition
            } catch(e) {
                showToast('auth-feedback', e.message, "error");
            }
        };

        window.logout = () => signOut(auth).then(() => location.reload());

        // --- AUTH STATE & LOADING ---
        onAuthStateChanged(auth, async (user) => {
            const loader = document.getElementById('loader');
            
            if (user) {
                currentUser = user;
                const snap = await getDoc(doc(db, "users", user.uid));
                
                if (snap.exists()) {
                    userData = snap.data();
                    loadApp(); 
                } else {
                    // New User -> Go to Setup View
                    loader.style.display = 'none';
                    document.getElementById('auth-view').style.display = 'none';
                    document.getElementById('setup-view').style.display = 'flex';
                }
            } else {
                // Logged Out -> Hide Nav, Show Auth
                document.getElementById('mobile-navbar').style.display = 'none';
                document.getElementById('header-title').style.display = 'none';
                document.getElementById('desktop-sidebar').style.display = 'none';
                
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
                document.getElementById('auth-view').classList.add('active');
            }
        });

        // --- SETUP NEW USER ---
        window.finalizeSetup = async () => {
            const name = document.getElementById('setup-name').value;
            if(!name) return; 
            
            await setDoc(doc(db, "users", currentUser.uid), { name, email: currentUser.email, coins: 0, familyId: null, role: null });
            document.getElementById('setup-view').style.display = 'none';
            
            const snap = await getDoc(doc(db, "users", currentUser.uid));
            userData = snap.data();
            loadApp();
        };

        // --- APP LOGIC ---
        function loadApp() {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('auth-view').classList.remove('active');
            
            if(window.innerWidth > 768) {
                document.getElementById('desktop-sidebar').style.display = 'flex';
            } else {
                document.getElementById('mobile-navbar').style.display = 'flex';
                document.getElementById('header-title').style.display = 'flex';
            }

            document.getElementById('display-name').innerText = userData.name;
            document.getElementById('user-email').innerText = currentUser.email;

            switchNav('home-view');
            
            onSnapshot(doc(db, "users", currentUser.uid), (d) => {
                document.getElementById('coin-count').innerText = d.data().coins || 0;
            });

            if(userData.familyId) {
                document.getElementById('no-fam-alert').style.display = 'none';
                document.getElementById('family-forms').style.display = 'none';
                document.getElementById('family-info').style.display = 'block';

                getDoc(doc(db, "families", userData.familyId)).then(s => {
                    if(s.exists()) {
                        document.getElementById('fam-name-display').innerText = s.data().name;
                        document.getElementById('fam-code-display').innerText = s.data().inviteCode;
                    }
                });
                loadTasks();
            } else {
                document.getElementById('no-fam-alert').style.display = 'block';
                document.getElementById('family-forms').style.display = 'block';
                document.getElementById('family-info').style.display = 'none';
            }
        }

        // --- NAV ---
        window.switchNav = (viewId) => {
            document.querySelectorAll('.view').forEach(v => {
                if(v.id !== 'auth-view' && v.id !== 'setup-view') v.classList.remove('active');
            });
            document.getElementById(viewId).classList.add('active');

            const titles = { 'home-view': 'Home', 'family-view': 'Family', 'store-view': 'Store', 'profile-view': 'Profile' };
            document.getElementById('header-title').innerText = titles[viewId];

            document.querySelectorAll('.mobile-tab').forEach(el => el.classList.remove('active'));
            if(viewId === 'home-view') document.querySelectorAll('.mobile-tab')[0].classList.add('active');
            else if(viewId === 'profile-view') document.querySelectorAll('.mobile-tab')[1].classList.add('active');
            else document.querySelectorAll('.mobile-tab')[2].classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if(viewId.includes('home')) document.getElementById('pc-home').classList.add('active');
            if(viewId.includes('fam')) document.getElementById('pc-fam').classList.add('active');
            if(viewId.includes('store')) document.getElementById('pc-store').classList.add('active');
            if(viewId.includes('prof')) document.getElementById('pc-prof').classList.add('active');
        };

        window.openSheet = () => document.getElementById('sheet-overlay').classList.add('open');
        window.closeSheet = (e) => {
            if(e && !e.target.classList.contains('sheet-overlay')) return;
            document.getElementById('sheet-overlay').classList.remove('open');
        };
        window.mobileGo = (id) => {
            document.getElementById('sheet-overlay').classList.remove('open');
            switchNav(id);
        };

        // --- BACKEND ---
        window.createFamily = async () => {
            const name = document.getElementById('create-fam-name').value;
            if(!name) return;
            const code = Math.floor(1000 + Math.random() * 9000).toString();
            const ref = await addDoc(collection(db, "families"), { name, inviteCode: code, admin: currentUser.uid });
            await updateDoc(doc(db, "users", currentUser.uid), { familyId: ref.id, role: 'parent' });
            location.reload();
        };

        window.joinFamily = async () => {
            const code = document.getElementById('join-fam-code').value;
            const q = query(collection(db, "families"), where("inviteCode", "==", code));
            const snap = await getDocs(q);
            if(snap.empty) {
                showToast('join-error', "Code not found", "error");
                return;
            }
            let fid = null; snap.forEach(d => fid = d.id);
            await updateDoc(doc(db, "users", currentUser.uid), { familyId: fid, role: 'child' });
            location.reload();
        };

        function loadTasks() {
            const q = query(collection(db, "tasks"), where("familyId", "==", userData.familyId));
            onSnapshot(q, (snap) => {
                const list = document.getElementById('task-list');
                list.innerHTML = "";
                if(snap.empty) return; 
                snap.forEach(d => {
                    const t = d.data();
                    list.innerHTML += `
                        <div class="list-item" style="cursor:default;">
                            <div style="display:flex; align-items:center;">
                                <div style="width:40px; height:40px; background:${t.status==='Done'?'var(--primary)':'#EEF2F9'}; color:${t.status==='Done'?'white':'inherit'}; border-radius:50%; display:flex; justify-content:center; align-items:center; margin-right:15px; font-weight:bold;">${t.status === 'Done' ? '‚úì' : ''}</div>
                                <div><div style="font-weight:700;">${t.title}</div><div style="font-size:13px; color:var(--text-sec);">+${t.reward} Tokens</div></div>
                            </div>
                        </div>`;
                });
            });
        }
    </script>
</body>
</html>
